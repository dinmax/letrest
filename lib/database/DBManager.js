/*! letrest - v0.3.1 - 2016-06-03 */function DatabaseConnection(){var a=this;a.activeConnection=null,a.createConnection=function(a){return UWDBManager.init().create(a)},a.getConnection=function(b){return a.activeConnection||(a.activeConnection=a.createConnection(b.database||CONFIG.default_DB.name)),a.activeConnection}}var CONFIG=require("../Config.js").getConfig(),UWDBManager=require("uw-db"),Q=require("q"),DBManager=function(a){var b=this;b.connection=null,b.strategy=null,b.initTransaction=function(){return b.connection.open().then(b.connection.begin)},b.finish=function(){return Q.when(b.connection.end()).then(function(){b.connection=null})},b.rollBackAndfinish=function(){return b.connection.rollbackAndRelease().then(function(){b.connection=null})},b.init=function(a){return a.database?(b.connection=(new DatabaseConnection).getConnection(a),CONFIG.databases.forEach(function(c,d){b.strategy=c.name==a.database?require("../rest/"+CONFIG.databases[d].strategy):null})):(b.connection=(new DatabaseConnection).getConnection(a),b.strategy=require("../rest/"+CONFIG.default_DB.strategy)),b}};exports.newInstance=function(){return new DBManager};