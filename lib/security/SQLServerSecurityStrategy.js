/*! letrest - v0.0.23 - 2015-05-04 */var CONFIG=require("../Config.js").getSecurity().config.STRATEGY,DB=require("uw").DB,LOG=require("uw").log,Q=require("q"),UTIL=require("util"),CONST_LOGIN_QUERY=UTIL.format("select * from %s where %s='%%s' and %s='%%s'",CONFIG.TABLE,CONFIG.FIELDS.NICK,CONFIG.FIELDS.PASSWORD),MODULE="SQLSERVER-SECURITY	";exports.register=function(){},exports.getRoles=function(){LOG.info(MODULE,"Retriving available roles");var a=Q.defer();return CONFIG.ROLE_JSON?(LOG.info(MODULE,"Using JSON provided instead query"),a.resolve(CONFIG.ROLE_JSON),a.promise):(DB.query(LOG.show(MODULE,CONFIG.ROLE_SQL)).then(function(b){a.resolve(b)})["catch"](function(b){LOG.error(MODULE,"Failed to executed credentials query."),a.reject(b)}),a.promise)},exports.login=function(a){LOG.info(MODULE,"Procesing login request for user:",a.username);var b=Q.defer();return DB.query(LOG.show(MODULE,UTIL.format(CONFIG.LOGIN_SQL||CONST_LOGIN_QUERY,a.username,a.password))).then(function(a){b.resolve(0==a.length?null:a[0])})["catch"](function(a){LOG.error(MODULE,"Failed to executed credentials query."),b.reject(a)}),b.promise},exports.logout=function(){};